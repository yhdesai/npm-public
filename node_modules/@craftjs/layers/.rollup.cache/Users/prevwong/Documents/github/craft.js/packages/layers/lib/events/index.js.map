{"version":3,"file":"index.js","sourceRoot":"","sources":["../../src/events/index.tsx"],"names":[],"mappings":"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","sourcesContent":["import { useEditor } from '@craftjs/core';\nimport { RenderIndicator } from '@craftjs/utils';\nimport React, { useMemo } from 'react';\n\nimport { useLayerManager } from '../manager/useLayerManager';\n\nexport const EventManager: React.FC<any> = ({ children }) => {\n  const { layers, events } = useLayerManager((state) => state);\n  const { store } = useEditor((state) => ({\n    enabled: state.options.enabled,\n  }));\n\n  const indicatorStyles = store.config.indicator;\n\n  const indicatorPosition = useMemo(() => {\n    const { indicator } = events;\n\n    if (indicator) {\n      const {\n        placement: { where, parent, currentNode },\n        error,\n      } = indicator;\n      const layerId = currentNode || parent;\n\n      let top;\n      const color = error ? indicatorStyles.error : indicatorStyles.success;\n\n      if (indicator.onCanvas && layers[parent].dom != null) {\n        const parentPos = layers[parent].dom.getBoundingClientRect();\n        const parentHeadingPos = layers[\n          parent\n        ].headingDom.getBoundingClientRect();\n        return {\n          top: parentHeadingPos.top,\n          left: parentPos.left,\n          width: parentPos.width,\n          height: parentHeadingPos.height,\n          background: 'transparent',\n          borderWidth: '1px',\n          borderColor: color,\n        };\n      } else {\n        if (!layers[layerId]) return;\n        const headingPos = layers[layerId].headingDom.getBoundingClientRect();\n        const pos = layers[layerId].dom.getBoundingClientRect();\n\n        if (where === 'after' || !currentNode) {\n          top = pos.top + pos.height;\n        } else {\n          top = pos.top;\n        }\n\n        return {\n          top,\n          left: headingPos.left,\n          width: pos.width - headingPos.left,\n          height: 2,\n          borderWidth: 0,\n          background: color,\n        };\n      }\n    }\n  }, [events, indicatorStyles.error, indicatorStyles.success, layers]);\n\n  return (\n    <div>\n      {events.indicator\n        ? React.createElement(RenderIndicator, {\n            style: indicatorPosition,\n          })\n        : null}\n      {children}\n    </div>\n  );\n};\n"]}