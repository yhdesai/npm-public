{"version":3,"file":"useCollector.js","sourceRoot":"","sources":["../../src/Store/useCollector.tsx"],"names":[],"mappings":"AAAA,OAAO,EAAE,QAAQ,EAAE,SAAS,EAAE,OAAO,EAAE,MAAM,EAAE,MAAM,OAAO,CAAC;AAI7D,MAAM,UAAU,YAAY,CAC1B,KAAQ,EACR,SAA0C;IAE1C,MAAM,CAAC,SAAS,EAAE,YAAY,CAAC,GAAG,QAAQ,CACxC,SAAS,CAAC,CAAC,CAAC,SAAS,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC,CAAE,EAAQ,CACpD,CAAC;IAEF,MAAM,YAAY,GAAG,MAAM,CAAC,SAAS,CAAC,CAAC;IACvC,YAAY,CAAC,OAAO,GAAG,SAAS,CAAC;IAEjC,MAAM,WAAW,GAAG,OAAO,CAAC,GAAG,EAAE;QAC/B,MAAM,EAAE,OAAO,EAAE,SAAS,EAAE,GAAG,YAAY,CAAC;QAE5C,IAAI,CAAC,SAAS,EAAE;YACd,OAAO;SACR;QAED,OAAO,KAAK,CAAC,SAAS,CAAC,YAAY,CAAC,OAAO,EAAE,CAAC,SAAS,EAAE,EAAE,CACzD,YAAY,CAAC,SAAS,CAAC,CACxB,CAAC;IACJ,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC;IAEZ,gCAAgC;IAChC,SAAS,CAAC,GAAG,EAAE;QACb,OAAO,GAAG,EAAE;YACV,IAAI,CAAC,WAAW,EAAE;gBAChB,OAAO;aACR;YAED,WAAW,EAAE,CAAC;QAChB,CAAC,CAAC;IACJ,CAAC,EAAE,CAAC,WAAW,CAAC,CAAC,CAAC;IAElB,OAAO,SAAoC,CAAC;AAC9C,CAAC","sourcesContent":["import { useState, useEffect, useMemo, useRef } from 'react';\n\nimport { Store, StateForStore } from './Store';\n\nexport function useCollector<S extends Store, C = null>(\n  store: S,\n  collector?: (state: StateForStore<S>) => C\n) {\n  const [collected, setCollected] = useState<any>(\n    collector ? collector(store.getState()) : ({} as C)\n  );\n\n  const collectorRef = useRef(collector);\n  collectorRef.current = collector;\n\n  const unsubscribe = useMemo(() => {\n    const { current: collector } = collectorRef;\n\n    if (!collector) {\n      return;\n    }\n\n    return store.subscribe(collectorRef.current, (collected) =>\n      setCollected(collected)\n    );\n  }, [store]);\n\n  // Collect state on state change\n  useEffect(() => {\n    return () => {\n      if (!unsubscribe) {\n        return;\n      }\n\n      unsubscribe();\n    };\n  }, [unsubscribe]);\n\n  return collected as C extends null ? {} : C;\n}\n"]}